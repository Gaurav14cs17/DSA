<svg viewBox="0 0 1000 700" xmlns="http://www.w3.org/2000/svg">
  <rect width="1000" height="700" fill="#0f0f23"/>
  
  <!-- Title -->
  <text x="500" y="30" font-family="Courier New, monospace" font-size="22" font-weight="bold" fill="#ffffff" text-anchor="middle">Parse Tree: K4(ON(SO3)2)2</text>
  <text x="500" y="55" font-family="Courier New, monospace" font-size="12" fill="#888888" text-anchor="middle">Complex nested formula broken into tree structure</text>
  
  <!-- Root -->
  <rect x="400" y="75" width="200" height="45" rx="8" fill="#1e3a5f" stroke="#3b82f6" stroke-width="3"/>
  <text x="500" y="95" font-family="Courier New, monospace" font-size="11" font-weight="bold" fill="#3b82f6" text-anchor="middle">Formula (root)</text>
  <text x="500" y="112" font-family="Courier New, monospace" font-size="9" fill="#888888" text-anchor="middle">K4(ON(SO3)2)2</text>
  
  <!-- Branches from root -->
  <line x1="450" y1="120" x2="200" y2="170" stroke="#4ade80" stroke-width="2"/>
  <line x1="550" y1="120" x2="700" y2="170" stroke="#f97316" stroke-width="2"/>
  
  <!-- K4 atom -->
  <rect x="100" y="175" width="180" height="60" rx="6" fill="#0f2f1f" stroke="#4ade80" stroke-width="2"/>
  <text x="190" y="200" font-family="Courier New, monospace" font-size="12" font-weight="bold" fill="#4ade80" text-anchor="middle">Atom: K4</text>
  <text x="190" y="222" font-family="Courier New, monospace" font-size="10" fill="#888888" text-anchor="middle">{"K": 4}</text>
  
  <!-- Group (...) -->
  <rect x="580" y="175" width="240" height="60" rx="6" fill="#3d1f0f" stroke="#f97316" stroke-width="2"/>
  <text x="700" y="200" font-family="Courier New, monospace" font-size="12" font-weight="bold" fill="#f97316" text-anchor="middle">Group: (ON(SO3)2)2</text>
  <text x="700" y="222" font-family="Courier New, monospace" font-size="10" fill="#888888" text-anchor="middle">parse inside, multiply by 2</text>
  
  <!-- Branch from group -->
  <line x1="700" y1="235" x2="700" y2="275" stroke="#a78bfa" stroke-width="2"/>
  <polygon points="700,285 695,275 705,275" fill="#a78bfa"/>
  
  <!-- Inner formula -->
  <rect x="550" y="290" width="300" height="45" rx="6" fill="#2d1f3d" stroke="#a78bfa" stroke-width="2"/>
  <text x="700" y="310" font-family="Courier New, monospace" font-size="11" font-weight="bold" fill="#a78bfa" text-anchor="middle">Formula (nested): ON(SO3)2</text>
  <text x="700" y="328" font-family="Courier New, monospace" font-size="9" fill="#888888" text-anchor="middle">RECURSION LEVEL 1</text>
  
  <!-- Branches from inner formula -->
  <line x1="600" y1="335" x2="420" y2="385" stroke="#4ade80" stroke-width="2"/>
  <line x1="650" y1="335" x2="580" y2="385" stroke="#4ade80" stroke-width="2"/>
  <line x1="800" y1="335" x2="850" y2="385" stroke="#f97316" stroke-width="2"/>
  
  <!-- O atom -->
  <rect x="340" y="390" width="120" height="50" rx="6" fill="#0f2f1f" stroke="#4ade80" stroke-width="2"/>
  <text x="400" y="415" font-family="Courier New, monospace" font-size="11" font-weight="bold" fill="#4ade80" text-anchor="middle">Atom: O</text>
  <text x="400" y="432" font-family="Courier New, monospace" font-size="9" fill="#888888" text-anchor="middle">{"O": 1}</text>
  
  <!-- N atom -->
  <rect x="500" y="390" width="120" height="50" rx="6" fill="#0f2f1f" stroke="#4ade80" stroke-width="2"/>
  <text x="560" y="415" font-family="Courier New, monospace" font-size="11" font-weight="bold" fill="#4ade80" text-anchor="middle">Atom: N</text>
  <text x="560" y="432" font-family="Courier New, monospace" font-size="9" fill="#888888" text-anchor="middle">{"N": 1}</text>
  
  <!-- Inner group -->
  <rect x="750" y="390" width="200" height="50" rx="6" fill="#3d1f0f" stroke="#f97316" stroke-width="2"/>
  <text x="850" y="415" font-family="Courier New, monospace" font-size="11" font-weight="bold" fill="#f97316" text-anchor="middle">Group: (SO3)2</text>
  <text x="850" y="432" font-family="Courier New, monospace" font-size="9" fill="#888888" text-anchor="middle">multiply by 2</text>
  
  <!-- Branch from innermost group -->
  <line x1="850" y1="440" x2="850" y2="475" stroke="#a78bfa" stroke-width="2"/>
  <polygon points="850,485 845,475 855,475" fill="#a78bfa"/>
  
  <!-- Innermost formula -->
  <rect x="750" y="490" width="200" height="45" rx="6" fill="#1e3a5f" stroke="#3b82f6" stroke-width="2"/>
  <text x="850" y="510" font-family="Courier New, monospace" font-size="11" font-weight="bold" fill="#3b82f6" text-anchor="middle">Formula: SO3</text>
  <text x="850" y="528" font-family="Courier New, monospace" font-size="9" fill="#888888" text-anchor="middle">RECURSION LEVEL 2</text>
  
  <!-- S and O3 branches -->
  <line x1="800" y1="535" x2="720" y2="575" stroke="#4ade80" stroke-width="2"/>
  <line x1="900" y1="535" x2="920" y2="575" stroke="#4ade80" stroke-width="2"/>
  
  <!-- S atom -->
  <rect x="640" y="580" width="120" height="50" rx="6" fill="#0f2f1f" stroke="#4ade80" stroke-width="2"/>
  <text x="700" y="605" font-family="Courier New, monospace" font-size="11" font-weight="bold" fill="#4ade80" text-anchor="middle">Atom: S</text>
  <text x="700" y="622" font-family="Courier New, monospace" font-size="9" fill="#888888" text-anchor="middle">{"S": 1}</text>
  
  <!-- O3 atom -->
  <rect x="840" y="580" width="120" height="50" rx="6" fill="#0f2f1f" stroke="#4ade80" stroke-width="2"/>
  <text x="900" y="605" font-family="Courier New, monospace" font-size="11" font-weight="bold" fill="#4ade80" text-anchor="middle">Atom: O3</text>
  <text x="900" y="622" font-family="Courier New, monospace" font-size="9" fill="#888888" text-anchor="middle">{"O": 3}</text>
  
  <!-- Calculation panel -->
  <rect x="50" y="300" width="250" height="350" rx="8" fill="#0f0f23" stroke="#3b82f6" stroke-width="2"/>
  <text x="175" y="330" font-family="Courier New, monospace" font-size="12" font-weight="bold" fill="#e94560" text-anchor="middle">Bottom-Up Calculation</text>
  
  <text x="70" y="360" font-family="Courier New, monospace" font-size="10" font-weight="bold" fill="#4ade80">Level 2 (deepest):</text>
  <text x="80" y="380" font-family="Courier New, monospace" font-size="9" fill="#ffffff">SO3 = {S:1, O:3}</text>
  
  <text x="70" y="410" font-family="Courier New, monospace" font-size="10" font-weight="bold" fill="#f97316">Multiply by 2:</text>
  <text x="80" y="430" font-family="Courier New, monospace" font-size="9" fill="#ffffff">(SO3)2 = {S:2, O:6}</text>
  
  <text x="70" y="460" font-family="Courier New, monospace" font-size="10" font-weight="bold" fill="#a78bfa">Level 1:</text>
  <text x="80" y="480" font-family="Courier New, monospace" font-size="9" fill="#ffffff">ON + (SO3)2</text>
  <text x="80" y="498" font-family="Courier New, monospace" font-size="9" fill="#ffffff">= {O:1, N:1} + {S:2, O:6}</text>
  <text x="80" y="516" font-family="Courier New, monospace" font-size="9" fill="#ffffff">= {N:1, O:7, S:2}</text>
  
  <text x="70" y="546" font-family="Courier New, monospace" font-size="10" font-weight="bold" fill="#f97316">Multiply by 2:</text>
  <text x="80" y="566" font-family="Courier New, monospace" font-size="9" fill="#ffffff">= {N:2, O:14, S:4}</text>
  
  <text x="70" y="596" font-family="Courier New, monospace" font-size="10" font-weight="bold" fill="#4ade80">Root level:</text>
  <text x="80" y="616" font-family="Courier New, monospace" font-size="9" fill="#ffffff">K4 + {N:2, O:14, S:4}</text>
  
  <rect x="70" y="625" width="210" height="25" rx="4" fill="#0f2f1f" stroke="#4ade80" stroke-width="2"/>
  <text x="175" y="643" font-family="Courier New, monospace" font-size="11" font-weight="bold" fill="#4ade80" text-anchor="middle">K4N2O14S4 âœ“</text>
</svg>

