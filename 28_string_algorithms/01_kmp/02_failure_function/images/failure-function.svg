<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 900 600">
  <rect width="900" height="600" fill="#0f0f23"/>
  
  <!-- Title -->
  <text x="450" y="35" text-anchor="middle" font-family="Courier New, monospace" font-size="26" font-weight="bold" fill="#ffffff">KMP Failure Function</text>
  <text x="450" y="58" text-anchor="middle" font-family="Courier New, monospace" font-size="16" fill="#888888">π-array: Longest Proper Prefix = Suffix</text>
  
  <!-- Definition Box -->
  <rect x="40" y="80" width="400" height="70" fill="#2d1f3d" stroke="#a78bfa" stroke-width="1.5" rx="5"/>
  <text x="60" y="105" font-family="Courier New, monospace" font-size="12" font-weight="bold" fill="#a78bfa">Definition</text>
  <text x="60" y="125" font-family="Courier New, monospace" font-size="11" fill="#ffffff">π[i] = max{ k : k &lt; i and P[0..k-1] = P[i-k+1..i] }</text>
  <text x="60" y="143" font-family="Courier New, monospace" font-size="10" fill="#888888">Length of longest proper prefix that is also suffix</text>
  
  <!-- Step-by-step computation -->
  <text x="40" y="180" font-family="Courier New, monospace" font-size="14" font-weight="bold" fill="#e94560">Computing π for Pattern: ABABCABAA</text>
  
  <!-- Pattern with indices -->
  <g transform="translate(40, 210)">
    <text x="0" y="0" font-family="Courier New, monospace" font-size="10" fill="#888888">Index:</text>
    <text x="65" y="0" font-family="Courier New, monospace" font-size="10" fill="#888888">0</text>
    <text x="95" y="0" font-family="Courier New, monospace" font-size="10" fill="#888888">1</text>
    <text x="125" y="0" font-family="Courier New, monospace" font-size="10" fill="#888888">2</text>
    <text x="155" y="0" font-family="Courier New, monospace" font-size="10" fill="#888888">3</text>
    <text x="185" y="0" font-family="Courier New, monospace" font-size="10" fill="#888888">4</text>
    <text x="215" y="0" font-family="Courier New, monospace" font-size="10" fill="#888888">5</text>
    <text x="245" y="0" font-family="Courier New, monospace" font-size="10" fill="#888888">6</text>
    <text x="275" y="0" font-family="Courier New, monospace" font-size="10" fill="#888888">7</text>
    <text x="305" y="0" font-family="Courier New, monospace" font-size="10" fill="#888888">8</text>
  </g>
  
  <g transform="translate(40, 235)">
    <text x="0" y="0" font-family="Courier New, monospace" font-size="10" fill="#888888">Pattern:</text>
    <rect x="55" y="-12" width="28" height="22" fill="#3d1f0f" stroke="#f97316" stroke-width="1.5"/>
    <text x="69" y="4" text-anchor="middle" font-family="Courier New, monospace" font-size="14" font-weight="bold" fill="#ffffff">A</text>
    <rect x="85" y="-12" width="28" height="22" fill="#3d1f0f" stroke="#f97316" stroke-width="1.5"/>
    <text x="99" y="4" text-anchor="middle" font-family="Courier New, monospace" font-size="14" font-weight="bold" fill="#ffffff">B</text>
    <rect x="115" y="-12" width="28" height="22" fill="#3d1f0f" stroke="#f97316" stroke-width="1.5"/>
    <text x="129" y="4" text-anchor="middle" font-family="Courier New, monospace" font-size="14" font-weight="bold" fill="#ffffff">A</text>
    <rect x="145" y="-12" width="28" height="22" fill="#3d1f0f" stroke="#f97316" stroke-width="1.5"/>
    <text x="159" y="4" text-anchor="middle" font-family="Courier New, monospace" font-size="14" font-weight="bold" fill="#ffffff">B</text>
    <rect x="175" y="-12" width="28" height="22" fill="#3d1f0f" stroke="#f97316" stroke-width="1.5"/>
    <text x="189" y="4" text-anchor="middle" font-family="Courier New, monospace" font-size="14" font-weight="bold" fill="#ffffff">C</text>
    <rect x="205" y="-12" width="28" height="22" fill="#3d1f0f" stroke="#f97316" stroke-width="1.5"/>
    <text x="219" y="4" text-anchor="middle" font-family="Courier New, monospace" font-size="14" font-weight="bold" fill="#ffffff">A</text>
    <rect x="235" y="-12" width="28" height="22" fill="#3d1f0f" stroke="#f97316" stroke-width="1.5"/>
    <text x="249" y="4" text-anchor="middle" font-family="Courier New, monospace" font-size="14" font-weight="bold" fill="#ffffff">B</text>
    <rect x="265" y="-12" width="28" height="22" fill="#3d1f0f" stroke="#f97316" stroke-width="1.5"/>
    <text x="279" y="4" text-anchor="middle" font-family="Courier New, monospace" font-size="14" font-weight="bold" fill="#ffffff">A</text>
    <rect x="295" y="-12" width="28" height="22" fill="#3d1f0f" stroke="#f97316" stroke-width="1.5"/>
    <text x="309" y="4" text-anchor="middle" font-family="Courier New, monospace" font-size="14" font-weight="bold" fill="#ffffff">A</text>
  </g>
  
  <g transform="translate(40, 265)">
    <text x="0" y="0" font-family="Courier New, monospace" font-size="10" fill="#888888">π[i]:</text>
    <rect x="55" y="-12" width="28" height="22" fill="#0f2f1f" stroke="#4ade80" stroke-width="1.5"/>
    <text x="69" y="4" text-anchor="middle" font-family="Courier New, monospace" font-size="14" font-weight="bold" fill="#4ade80">0</text>
    <rect x="85" y="-12" width="28" height="22" fill="#0f2f1f" stroke="#4ade80" stroke-width="1.5"/>
    <text x="99" y="4" text-anchor="middle" font-family="Courier New, monospace" font-size="14" font-weight="bold" fill="#4ade80">0</text>
    <rect x="115" y="-12" width="28" height="22" fill="#0f2f1f" stroke="#4ade80" stroke-width="1.5"/>
    <text x="129" y="4" text-anchor="middle" font-family="Courier New, monospace" font-size="14" font-weight="bold" fill="#4ade80">1</text>
    <rect x="145" y="-12" width="28" height="22" fill="#0f2f1f" stroke="#4ade80" stroke-width="1.5"/>
    <text x="159" y="4" text-anchor="middle" font-family="Courier New, monospace" font-size="14" font-weight="bold" fill="#4ade80">2</text>
    <rect x="175" y="-12" width="28" height="22" fill="#0f2f1f" stroke="#4ade80" stroke-width="1.5"/>
    <text x="189" y="4" text-anchor="middle" font-family="Courier New, monospace" font-size="14" font-weight="bold" fill="#4ade80">0</text>
    <rect x="205" y="-12" width="28" height="22" fill="#0f2f1f" stroke="#4ade80" stroke-width="1.5"/>
    <text x="219" y="4" text-anchor="middle" font-family="Courier New, monospace" font-size="14" font-weight="bold" fill="#4ade80">1</text>
    <rect x="235" y="-12" width="28" height="22" fill="#0f2f1f" stroke="#4ade80" stroke-width="1.5"/>
    <text x="249" y="4" text-anchor="middle" font-family="Courier New, monospace" font-size="14" font-weight="bold" fill="#4ade80">2</text>
    <rect x="265" y="-12" width="28" height="22" fill="#0f2f1f" stroke="#4ade80" stroke-width="1.5"/>
    <text x="279" y="4" text-anchor="middle" font-family="Courier New, monospace" font-size="14" font-weight="bold" fill="#4ade80">3</text>
    <rect x="295" y="-12" width="28" height="22" fill="#0f2f1f" stroke="#4ade80" stroke-width="1.5"/>
    <text x="309" y="4" text-anchor="middle" font-family="Courier New, monospace" font-size="14" font-weight="bold" fill="#4ade80">1</text>
  </g>
  
  <!-- Border chain visualization -->
  <text x="480" y="180" font-family="Courier New, monospace" font-size="14" font-weight="bold" fill="#e94560">Border Chain Example</text>
  
  <g transform="translate(480, 200)">
    <text x="0" y="0" font-family="Courier New, monospace" font-size="11" fill="#888888">At i=7: P[0..7] = "ABABCABA"</text>
    
    <rect x="0" y="15" width="160" height="30" fill="#1e3a5f" stroke="#3b82f6" stroke-width="1.5" rx="3"/>
    <text x="80" y="35" text-anchor="middle" font-family="Courier New, monospace" font-size="12" fill="#ffffff">A B A B C A B A</text>
    
    <!-- Show borders -->
    <text x="0" y="65" font-family="Courier New, monospace" font-size="11" fill="#4ade80">Border 1: "ABA" (length 3)</text>
    <rect x="0" y="75" width="60" height="22" fill="#0f2f1f" stroke="#4ade80" stroke-width="1"/>
    <text x="30" y="90" text-anchor="middle" font-family="Courier New, monospace" font-size="11" fill="#4ade80">A B A</text>
    <text x="70" y="90" font-family="Courier New, monospace" font-size="11" fill="#888888">= prefix</text>
    <rect x="100" y="75" width="60" height="22" fill="#0f2f1f" stroke="#4ade80" stroke-width="1"/>
    <text x="130" y="90" text-anchor="middle" font-family="Courier New, monospace" font-size="11" fill="#4ade80">A B A</text>
    <text x="170" y="90" font-family="Courier New, monospace" font-size="11" fill="#888888">= suffix</text>
    
    <text x="0" y="120" font-family="Courier New, monospace" font-size="11" fill="#a78bfa">Border 2: "A" (length 1)</text>
    <rect x="0" y="130" width="24" height="22" fill="#2d1f3d" stroke="#a78bfa" stroke-width="1"/>
    <text x="12" y="145" text-anchor="middle" font-family="Courier New, monospace" font-size="11" fill="#a78bfa">A</text>
    
    <text x="0" y="175" font-family="Courier New, monospace" font-size="10" fill="#888888">Chain: π[7]=3 → π[2]=1 → π[0]=0</text>
  </g>
  
  <!-- Step-by-step explanations -->
  <text x="40" y="310" font-family="Courier New, monospace" font-size="14" font-weight="bold" fill="#e94560">Step-by-Step Computation</text>
  
  <g transform="translate(40, 330)">
    <text x="0" y="0" font-family="Courier New, monospace" font-size="10" fill="#a78bfa">i=0:</text>
    <text x="40" y="0" font-family="Courier New, monospace" font-size="10" fill="#888888">π[0] = 0 (by definition)</text>
    
    <text x="0" y="18" font-family="Courier New, monospace" font-size="10" fill="#a78bfa">i=1:</text>
    <text x="40" y="18" font-family="Courier New, monospace" font-size="10" fill="#888888">"AB" → no proper prefix=suffix → π[1] = 0</text>
    
    <text x="0" y="36" font-family="Courier New, monospace" font-size="10" fill="#a78bfa">i=2:</text>
    <text x="40" y="36" font-family="Courier New, monospace" font-size="10" fill="#4ade80">"ABA" → "A" matches → π[2] = 1</text>
    
    <text x="0" y="54" font-family="Courier New, monospace" font-size="10" fill="#a78bfa">i=3:</text>
    <text x="40" y="54" font-family="Courier New, monospace" font-size="10" fill="#4ade80">"ABAB" → "AB" matches → π[3] = 2</text>
    
    <text x="0" y="72" font-family="Courier New, monospace" font-size="10" fill="#a78bfa">i=4:</text>
    <text x="40" y="72" font-family="Courier New, monospace" font-size="10" fill="#888888">"ABABC" → C≠A, fallback → π[4] = 0</text>
    
    <text x="0" y="90" font-family="Courier New, monospace" font-size="10" fill="#a78bfa">i=5:</text>
    <text x="40" y="90" font-family="Courier New, monospace" font-size="10" fill="#4ade80">"ABABCA" → "A" matches → π[5] = 1</text>
    
    <text x="0" y="108" font-family="Courier New, monospace" font-size="10" fill="#a78bfa">i=6:</text>
    <text x="40" y="108" font-family="Courier New, monospace" font-size="10" fill="#4ade80">"ABABCAB" → "AB" matches → π[6] = 2</text>
    
    <text x="0" y="126" font-family="Courier New, monospace" font-size="10" fill="#a78bfa">i=7:</text>
    <text x="40" y="126" font-family="Courier New, monospace" font-size="10" fill="#4ade80">"ABABCABA" → "ABA" matches → π[7] = 3</text>
    
    <text x="0" y="144" font-family="Courier New, monospace" font-size="10" fill="#a78bfa">i=8:</text>
    <text x="40" y="144" font-family="Courier New, monospace" font-size="10" fill="#888888">"ABABCABAA" → A≠C (at π[7]), fallback → π[8] = 1</text>
  </g>
  
  <!-- Properties Box -->
  <rect x="480" y="400" width="380" height="140" fill="#1e3a5f" stroke="#3b82f6" stroke-width="1.5" rx="5"/>
  <text x="500" y="425" font-family="Courier New, monospace" font-size="12" font-weight="bold" fill="#ffffff">Key Properties</text>
  <text x="500" y="450" font-family="Courier New, monospace" font-size="11" fill="#4ade80">• π[i] ≤ π[i-1] + 1</text>
  <text x="500" y="470" font-family="Courier New, monospace" font-size="11" fill="#4ade80">• All borders via chain: π → π[π-1] → ...</text>
  <text x="500" y="490" font-family="Courier New, monospace" font-size="11" fill="#4ade80">• Period detection: p = n - π[n-1]</text>
  <text x="500" y="510" font-family="Courier New, monospace" font-size="11" fill="#f97316">• Time: O(m) amortized</text>
  <text x="500" y="530" font-family="Courier New, monospace" font-size="11" fill="#a78bfa">• Space: O(m)</text>
  
  <!-- Applications -->
  <text x="40" y="510" font-family="Courier New, monospace" font-size="14" font-weight="bold" fill="#e94560">Applications</text>
  <text x="40" y="535" font-family="Courier New, monospace" font-size="11" fill="#888888">• Pattern matching  • Period detection  • Longest happy prefix  • Shortest palindrome</text>
  <text x="40" y="555" font-family="Courier New, monospace" font-size="11" fill="#888888">• Border enumeration  • String compression analysis</text>
</svg>

