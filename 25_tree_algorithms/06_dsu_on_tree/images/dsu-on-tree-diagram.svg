<svg viewBox="0 0 950 700" xmlns="http://www.w3.org/2000/svg">
  <rect width="950" height="700" fill="#0f0f23"/>
  
  <!-- Title -->
  <text x="475" y="40" font-family="Courier New, monospace" font-size="26" font-weight="bold" fill="#ffffff" text-anchor="middle">DSU on Tree (Small to Large)</text>
  <text x="475" y="65" font-family="Courier New, monospace" font-size="16" fill="#888888" text-anchor="middle">Efficient Subtree Queries in O(n log n)</text>
  
  <!-- Left: Tree with Heavy Child -->
  <text x="60" y="105" font-family="Courier New, monospace" font-size="14" font-weight="bold" fill="#e94560">TREE WITH HEAVY/LIGHT CHILDREN</text>
  
  <!-- Root -->
  <circle cx="200" cy="160" r="25" fill="#0f2f1f" stroke="#4ade80" stroke-width="3"/>
  <text x="200" y="166" font-family="Courier New, monospace" font-size="16" font-weight="bold" fill="#ffffff" text-anchor="middle">A</text>
  <text x="235" y="150" font-family="Courier New, monospace" font-size="10" fill="#888888">size=7</text>
  
  <!-- Level 1 -->
  <circle cx="120" cy="250" r="25" fill="#3d1f0f" stroke="#f97316" stroke-width="3"/>
  <text x="120" y="256" font-family="Courier New, monospace" font-size="16" font-weight="bold" fill="#ffffff" text-anchor="middle">B</text>
  <text x="90" y="240" font-family="Courier New, monospace" font-size="10" fill="#f97316">size=4</text>
  <text x="90" y="255" font-family="Courier New, monospace" font-size="9" fill="#f97316">HEAVY</text>
  
  <circle cx="280" cy="250" r="25" fill="#1e3a5f" stroke="#3b82f6" stroke-width="2"/>
  <text x="280" y="256" font-family="Courier New, monospace" font-size="16" font-weight="bold" fill="#ffffff" text-anchor="middle">C</text>
  <text x="315" y="245" font-family="Courier New, monospace" font-size="10" fill="#888888">size=2</text>
  <text x="315" y="260" font-family="Courier New, monospace" font-size="9" fill="#888888">light</text>
  
  <!-- Level 2 -->
  <circle cx="70" cy="340" r="22" fill="#1e3a5f" stroke="#3b82f6" stroke-width="2"/>
  <text x="70" y="346" font-family="Courier New, monospace" font-size="14" font-weight="bold" fill="#ffffff" text-anchor="middle">D</text>
  
  <circle cx="170" cy="340" r="22" fill="#1e3a5f" stroke="#3b82f6" stroke-width="2"/>
  <text x="170" y="346" font-family="Courier New, monospace" font-size="14" font-weight="bold" fill="#ffffff" text-anchor="middle">E</text>
  
  <circle cx="280" cy="340" r="22" fill="#1e3a5f" stroke="#3b82f6" stroke-width="2"/>
  <text x="280" y="346" font-family="Courier New, monospace" font-size="14" font-weight="bold" fill="#ffffff" text-anchor="middle">F</text>
  
  <!-- Level 3 -->
  <circle cx="50" cy="420" r="20" fill="#2d1f3d" stroke="#a78bfa" stroke-width="2"/>
  <text x="50" y="426" font-family="Courier New, monospace" font-size="12" font-weight="bold" fill="#ffffff" text-anchor="middle">G</text>
  
  <!-- Edges -->
  <line x1="200" y1="185" x2="120" y2="225" stroke="#f97316" stroke-width="4"/>
  <line x1="200" y1="185" x2="280" y2="225" stroke="#3b82f6" stroke-width="2" stroke-dasharray="5,3"/>
  <line x1="120" y1="275" x2="70" y2="318" stroke="#f97316" stroke-width="4"/>
  <line x1="120" y1="275" x2="170" y2="318" stroke="#3b82f6" stroke-width="2" stroke-dasharray="5,3"/>
  <line x1="280" y1="275" x2="280" y2="318" stroke="#3b82f6" stroke-width="2" stroke-dasharray="5,3"/>
  <line x1="70" y1="362" x2="50" y2="400" stroke="#a78bfa" stroke-width="2" stroke-dasharray="5,3"/>
  
  <!-- Algorithm Steps -->
  <text x="430" y="105" font-family="Courier New, monospace" font-size="14" font-weight="bold" fill="#e94560">ALGORITHM (for node A)</text>
  
  <!-- Step 1 -->
  <rect x="400" y="125" width="250" height="50" fill="#1f0f0f" stroke="#ef4444" stroke-width="2" rx="5"/>
  <text x="410" y="145" font-family="Courier New, monospace" font-size="11" fill="#ef4444">STEP 1: Process light child (C)</text>
  <text x="410" y="165" font-family="Courier New, monospace" font-size="10" fill="#ffffff">â†’ Compute, then REMOVE data</text>
  
  <!-- Step 2 -->
  <rect x="400" y="185" width="250" height="50" fill="#0f2f1f" stroke="#4ade80" stroke-width="2" rx="5"/>
  <text x="410" y="205" font-family="Courier New, monospace" font-size="11" fill="#4ade80">STEP 2: Process heavy child (B)</text>
  <text x="410" y="225" font-family="Courier New, monospace" font-size="10" fill="#ffffff">â†’ Compute, KEEP data in memory</text>
  
  <!-- Step 3 -->
  <rect x="400" y="245" width="250" height="50" fill="#3d1f0f" stroke="#f97316" stroke-width="2" rx="5"/>
  <text x="410" y="265" font-family="Courier New, monospace" font-size="11" fill="#f97316">STEP 3: Add light subtrees to data</text>
  <text x="410" y="285" font-family="Courier New, monospace" font-size="10" fill="#ffffff">â†’ Merge C's subtree into B's data</text>
  
  <!-- Step 4 -->
  <rect x="400" y="305" width="250" height="50" fill="#2d1f3d" stroke="#a78bfa" stroke-width="2" rx="5"/>
  <text x="410" y="325" font-family="Courier New, monospace" font-size="11" fill="#a78bfa">STEP 4: Add current node (A)</text>
  <text x="410" y="345" font-family="Courier New, monospace" font-size="10" fill="#ffffff">â†’ Compute answer for A</text>
  
  <!-- Right: Example - Count Distinct Colors -->
  <text x="700" y="105" font-family="Courier New, monospace" font-size="14" font-weight="bold" fill="#e94560">EXAMPLE: COUNT DISTINCT</text>
  
  <!-- Nodes with colors -->
  <circle cx="750" cy="160" r="22" fill="#0f2f1f" stroke="#4ade80" stroke-width="2"/>
  <text x="750" y="166" font-family="Courier New, monospace" font-size="14" fill="#ffffff" text-anchor="middle">ðŸ”´</text>
  
  <circle cx="700" cy="230" r="20" fill="#1e3a5f" stroke="#3b82f6" stroke-width="2"/>
  <text x="700" y="236" font-family="Courier New, monospace" font-size="12" fill="#ffffff" text-anchor="middle">ðŸ”µ</text>
  
  <circle cx="800" cy="230" r="20" fill="#1e3a5f" stroke="#3b82f6" stroke-width="2"/>
  <text x="800" y="236" font-family="Courier New, monospace" font-size="12" fill="#ffffff" text-anchor="middle">ðŸ”´</text>
  
  <circle cx="670" cy="300" r="18" fill="#2d1f3d" stroke="#a78bfa" stroke-width="2"/>
  <text x="670" y="306" font-family="Courier New, monospace" font-size="11" fill="#ffffff" text-anchor="middle">ðŸŸ¢</text>
  
  <circle cx="730" cy="300" r="18" fill="#2d1f3d" stroke="#a78bfa" stroke-width="2"/>
  <text x="730" y="306" font-family="Courier New, monospace" font-size="11" fill="#ffffff" text-anchor="middle">ðŸ”µ</text>
  
  <line x1="750" y1="182" x2="700" y2="210" stroke="#3b82f6" stroke-width="2"/>
  <line x1="750" y1="182" x2="800" y2="210" stroke="#3b82f6" stroke-width="2"/>
  <line x1="700" y1="250" x2="670" y2="282" stroke="#3b82f6" stroke-width="2"/>
  <line x1="700" y1="250" x2="730" y2="282" stroke="#3b82f6" stroke-width="2"/>
  
  <!-- Answers -->
  <rect x="840" y="140" width="70" height="30" fill="#0f2f1f" stroke="#4ade80" stroke-width="1" rx="3"/>
  <text x="875" y="160" font-family="Courier New, monospace" font-size="11" fill="#4ade80" text-anchor="middle">ans=3</text>
  
  <rect x="840" y="210" width="70" height="25" fill="#1e3a5f" stroke="#3b82f6" stroke-width="1" rx="3"/>
  <text x="875" y="228" font-family="Courier New, monospace" font-size="10" fill="#ffffff" text-anchor="middle">ans=2</text>
  
  <rect x="620" y="285" width="50" height="20" fill="#2d1f3d" stroke="#a78bfa" stroke-width="1" rx="3"/>
  <text x="645" y="300" font-family="Courier New, monospace" font-size="9" fill="#ffffff" text-anchor="middle">a=1</text>
  
  <!-- Key Insight -->
  <text x="430" y="400" font-family="Courier New, monospace" font-size="14" font-weight="bold" fill="#e94560">KEY INSIGHT</text>
  
  <rect x="400" y="415" width="500" height="70" fill="#1e3a5f" stroke="#3b82f6" stroke-width="2" rx="5"/>
  <text x="650" y="440" font-family="Courier New, monospace" font-size="12" fill="#ffffff" text-anchor="middle">Each element is added/removed O(log n) times</text>
  <text x="650" y="460" font-family="Courier New, monospace" font-size="11" fill="#4ade80" text-anchor="middle">â†“</text>
  <text x="650" y="478" font-family="Courier New, monospace" font-size="12" fill="#4ade80" text-anchor="middle">Total: O(n log n) instead of O(nÂ²)</text>
  
  <!-- Data Structure -->
  <text x="60" y="460" font-family="Courier New, monospace" font-size="14" font-weight="bold" fill="#e94560">DATA STRUCTURE</text>
  
  <rect x="40" y="475" width="300" height="80" fill="#3d1f0f" stroke="#f97316" stroke-width="2" rx="5"/>
  <text x="190" y="500" font-family="Courier New, monospace" font-size="11" fill="#f97316" text-anchor="middle">Global Counter (freq map)</text>
  <text x="190" y="525" font-family="Courier New, monospace" font-size="10" fill="#ffffff" text-anchor="middle">counter[color] = frequency</text>
  <text x="190" y="545" font-family="Courier New, monospace" font-size="10" fill="#888888" text-anchor="middle">Supports add/remove in O(1)</text>
  
  <!-- Applications -->
  <text x="60" y="580" font-family="Courier New, monospace" font-size="14" font-weight="bold" fill="#e94560">APPLICATIONS</text>
  
  <rect x="40" y="595" width="200" height="80" fill="#1e3a5f" stroke="#3b82f6" stroke-width="2" rx="5"/>
  <text x="140" y="620" font-family="Courier New, monospace" font-size="11" font-weight="bold" fill="#3b82f6" text-anchor="middle">Distinct Colors</text>
  <text x="140" y="640" font-family="Courier New, monospace" font-size="10" fill="#ffffff" text-anchor="middle">Count unique values</text>
  <text x="140" y="660" font-family="Courier New, monospace" font-size="10" fill="#ffffff" text-anchor="middle">in each subtree</text>
  
  <rect x="260" y="595" width="200" height="80" fill="#0f2f1f" stroke="#4ade80" stroke-width="2" rx="5"/>
  <text x="360" y="620" font-family="Courier New, monospace" font-size="11" font-weight="bold" fill="#4ade80" text-anchor="middle">Mode Finding</text>
  <text x="360" y="640" font-family="Courier New, monospace" font-size="10" fill="#ffffff" text-anchor="middle">Most frequent value</text>
  <text x="360" y="660" font-family="Courier New, monospace" font-size="10" fill="#ffffff" text-anchor="middle">in each subtree</text>
  
  <rect x="480" y="595" width="200" height="80" fill="#2d1f3d" stroke="#a78bfa" stroke-width="2" rx="5"/>
  <text x="580" y="620" font-family="Courier New, monospace" font-size="11" font-weight="bold" fill="#a78bfa" text-anchor="middle">Range Queries</text>
  <text x="580" y="640" font-family="Courier New, monospace" font-size="10" fill="#ffffff" text-anchor="middle">Count values in range</text>
  <text x="580" y="660" font-family="Courier New, monospace" font-size="10" fill="#ffffff" text-anchor="middle">[L, R] per subtree</text>
  
  <!-- Complexity Box -->
  <rect x="700" y="595" width="200" height="80" fill="#3d1f0f" stroke="#f97316" stroke-width="2" rx="5"/>
  <text x="800" y="620" font-family="Courier New, monospace" font-size="12" font-weight="bold" fill="#f97316" text-anchor="middle">COMPLEXITY</text>
  <text x="800" y="645" font-family="Courier New, monospace" font-size="11" fill="#ffffff" text-anchor="middle">Time: O(n log n)</text>
  <text x="800" y="665" font-family="Courier New, monospace" font-size="11" fill="#ffffff" text-anchor="middle">Space: O(n)</text>
  
  <!-- Legend -->
  <line x1="60" y="85" x2="100" y2="85" stroke="#f97316" stroke-width="4"/>
  <text x="110" y="89" font-family="Courier New, monospace" font-size="10" fill="#ffffff">Heavy edge (keep data)</text>
  <line x1="260" y="85" x2="300" y2="85" stroke="#3b82f6" stroke-width="2" stroke-dasharray="5,3"/>
  <text x="310" y="89" font-family="Courier New, monospace" font-size="10" fill="#ffffff">Light edge (remove data)</text>
</svg>
