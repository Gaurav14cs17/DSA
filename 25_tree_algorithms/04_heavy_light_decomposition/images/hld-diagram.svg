<svg viewBox="0 0 950 700" xmlns="http://www.w3.org/2000/svg">
  <rect width="950" height="700" fill="#0f0f23"/>
  
  <!-- Title -->
  <text x="475" y="40" font-family="Courier New, monospace" font-size="26" font-weight="bold" fill="#ffffff" text-anchor="middle">Heavy-Light Decomposition (HLD)</text>
  <text x="475" y="65" font-family="Courier New, monospace" font-size="16" fill="#888888" text-anchor="middle">Path Queries in O(log² n) | Decompose into Chains</text>
  
  <!-- Left: Original Tree with Heavy/Light edges -->
  <text x="60" y="105" font-family="Courier New, monospace" font-size="14" font-weight="bold" fill="#e94560">TREE WITH HEAVY/LIGHT EDGES</text>
  
  <!-- Nodes -->
  <circle cx="220" cy="150" r="25" fill="#0f2f1f" stroke="#4ade80" stroke-width="3"/>
  <text x="220" y="156" font-family="Courier New, monospace" font-size="18" font-weight="bold" fill="#ffffff" text-anchor="middle">1</text>
  <text x="250" y="145" font-family="Courier New, monospace" font-size="10" fill="#888888">size=11</text>
  
  <circle cx="120" cy="240" r="25" fill="#1e3a5f" stroke="#3b82f6" stroke-width="2"/>
  <text x="120" y="246" font-family="Courier New, monospace" font-size="18" font-weight="bold" fill="#ffffff" text-anchor="middle">2</text>
  <text x="90" y="235" font-family="Courier New, monospace" font-size="10" fill="#888888">s=6</text>
  
  <circle cx="320" cy="240" r="25" fill="#1e3a5f" stroke="#3b82f6" stroke-width="2"/>
  <text x="320" y="246" font-family="Courier New, monospace" font-size="18" font-weight="bold" fill="#ffffff" text-anchor="middle">3</text>
  <text x="350" y="235" font-family="Courier New, monospace" font-size="10" fill="#888888">s=4</text>
  
  <circle cx="60" cy="330" r="25" fill="#1e3a5f" stroke="#3b82f6" stroke-width="2"/>
  <text x="60" y="336" font-family="Courier New, monospace" font-size="18" font-weight="bold" fill="#ffffff" text-anchor="middle">4</text>
  <text x="30" y="325" font-family="Courier New, monospace" font-size="10" fill="#888888">s=3</text>
  
  <circle cx="180" cy="330" r="25" fill="#1e3a5f" stroke="#3b82f6" stroke-width="2"/>
  <text x="180" y="336" font-family="Courier New, monospace" font-size="18" font-weight="bold" fill="#ffffff" text-anchor="middle">5</text>
  <text x="210" y="325" font-family="Courier New, monospace" font-size="10" fill="#888888">s=2</text>
  
  <circle cx="280" cy="330" r="25" fill="#1e3a5f" stroke="#3b82f6" stroke-width="2"/>
  <text x="280" y="336" font-family="Courier New, monospace" font-size="18" font-weight="bold" fill="#ffffff" text-anchor="middle">6</text>
  <text x="250" y="325" font-family="Courier New, monospace" font-size="10" fill="#888888">s=2</text>
  
  <circle cx="360" cy="330" r="25" fill="#1e3a5f" stroke="#3b82f6" stroke-width="2"/>
  <text x="360" y="336" font-family="Courier New, monospace" font-size="18" font-weight="bold" fill="#ffffff" text-anchor="middle">7</text>
  <text x="390" y="325" font-family="Courier New, monospace" font-size="10" fill="#888888">s=1</text>
  
  <circle cx="40" cy="420" r="25" fill="#2d1f3d" stroke="#a78bfa" stroke-width="2"/>
  <text x="40" y="426" font-family="Courier New, monospace" font-size="18" font-weight="bold" fill="#ffffff" text-anchor="middle">8</text>
  
  <circle cx="80" cy="420" r="25" fill="#2d1f3d" stroke="#a78bfa" stroke-width="2"/>
  <text x="80" y="426" font-family="Courier New, monospace" font-size="18" font-weight="bold" fill="#ffffff" text-anchor="middle">9</text>
  
  <circle cx="160" cy="420" r="25" fill="#2d1f3d" stroke="#a78bfa" stroke-width="2"/>
  <text x="160" y="426" font-family="Courier New, monospace" font-size="18" font-weight="bold" fill="#ffffff" text-anchor="middle">10</text>
  
  <circle cx="300" cy="420" r="25" fill="#2d1f3d" stroke="#a78bfa" stroke-width="2"/>
  <text x="300" y="426" font-family="Courier New, monospace" font-size="18" font-weight="bold" fill="#ffffff" text-anchor="middle">11</text>
  
  <!-- Heavy edges (thick) -->
  <line x1="220" y1="175" x2="120" y2="215" stroke="#4ade80" stroke-width="5"/>
  <line x1="120" y1="265" x2="60" y2="305" stroke="#4ade80" stroke-width="5"/>
  <line x1="60" y1="355" x2="40" y2="395" stroke="#4ade80" stroke-width="5"/>
  <line x1="320" y1="265" x2="280" y2="305" stroke="#4ade80" stroke-width="5"/>
  <line x1="280" y1="355" x2="300" y2="395" stroke="#4ade80" stroke-width="5"/>
  
  <!-- Light edges (thin, dashed) -->
  <line x1="220" y1="175" x2="320" y2="215" stroke="#f97316" stroke-width="2" stroke-dasharray="5,3"/>
  <line x1="120" y1="265" x2="180" y2="305" stroke="#f97316" stroke-width="2" stroke-dasharray="5,3"/>
  <line x1="60" y1="355" x2="80" y2="395" stroke="#f97316" stroke-width="2" stroke-dasharray="5,3"/>
  <line x1="180" y1="355" x2="160" y2="395" stroke="#f97316" stroke-width="2" stroke-dasharray="5,3"/>
  <line x1="320" y1="265" x2="360" y2="305" stroke="#f97316" stroke-width="2" stroke-dasharray="5,3"/>
  
  <!-- Legend -->
  <line x1="40" y1="475" x2="90" y2="475" stroke="#4ade80" stroke-width="5"/>
  <text x="100" y="480" font-family="Courier New, monospace" font-size="11" fill="#ffffff">Heavy edge</text>
  <line x1="200" y1="475" x2="250" y2="475" stroke="#f97316" stroke-width="2" stroke-dasharray="5,3"/>
  <text x="260" y="480" font-family="Courier New, monospace" font-size="11" fill="#ffffff">Light edge</text>
  
  <!-- Right: Chains -->
  <text x="520" y="105" font-family="Courier New, monospace" font-size="14" font-weight="bold" fill="#e94560">HEAVY CHAINS</text>
  
  <!-- Chain 1: 1-2-4-8 -->
  <rect x="490" y="125" width="180" height="130" fill="#0f2f1f" stroke="#4ade80" stroke-width="3" rx="10"/>
  <text x="580" y="150" font-family="Courier New, monospace" font-size="12" font-weight="bold" fill="#4ade80" text-anchor="middle">Chain 1 (head: 1)</text>
  <text x="580" y="180" font-family="Courier New, monospace" font-size="16" fill="#ffffff" text-anchor="middle">1 → 2 → 4 → 8</text>
  <text x="580" y="210" font-family="Courier New, monospace" font-size="11" fill="#888888" text-anchor="middle">pos: [0, 1, 2, 3]</text>
  <text x="580" y="240" font-family="Courier New, monospace" font-size="11" fill="#60a5fa" text-anchor="middle">Contiguous in array</text>
  
  <!-- Chain 2: 3-6-11 -->
  <rect x="700" y="125" width="180" height="100" fill="#1e3a5f" stroke="#3b82f6" stroke-width="3" rx="10"/>
  <text x="790" y="150" font-family="Courier New, monospace" font-size="12" font-weight="bold" fill="#3b82f6" text-anchor="middle">Chain 2 (head: 3)</text>
  <text x="790" y="180" font-family="Courier New, monospace" font-size="16" fill="#ffffff" text-anchor="middle">3 → 6 → 11</text>
  <text x="790" y="210" font-family="Courier New, monospace" font-size="11" fill="#888888" text-anchor="middle">pos: [4, 5, 6]</text>
  
  <!-- Single node chains -->
  <rect x="490" y="270" width="120" height="60" fill="#3d1f0f" stroke="#f97316" stroke-width="2" rx="10"/>
  <text x="550" y="295" font-family="Courier New, monospace" font-size="11" fill="#f97316" text-anchor="middle">Chain 3: 5→10</text>
  <text x="550" y="315" font-family="Courier New, monospace" font-size="10" fill="#888888" text-anchor="middle">pos: [7, 8]</text>
  
  <rect x="630" y="270" width="80" height="60" fill="#2d1f3d" stroke="#a78bfa" stroke-width="2" rx="10"/>
  <text x="670" y="295" font-family="Courier New, monospace" font-size="11" fill="#a78bfa" text-anchor="middle">Chain 4: 9</text>
  <text x="670" y="315" font-family="Courier New, monospace" font-size="10" fill="#888888" text-anchor="middle">pos: [9]</text>
  
  <rect x="730" y="270" width="80" height="60" fill="#2d1f3d" stroke="#a78bfa" stroke-width="2" rx="10"/>
  <text x="770" y="295" font-family="Courier New, monospace" font-size="11" fill="#a78bfa" text-anchor="middle">Chain 5: 7</text>
  <text x="770" y="315" font-family="Courier New, monospace" font-size="10" fill="#888888" text-anchor="middle">pos: [10]</text>
  
  <!-- Flattened Array -->
  <text x="520" y="370" font-family="Courier New, monospace" font-size="14" font-weight="bold" fill="#e94560">FLATTENED ARRAY (DFS ORDER)</text>
  
  <rect x="490" y="385" width="40" height="35" fill="#0f2f1f" stroke="#4ade80" stroke-width="2"/>
  <text x="510" y="408" font-family="Courier New, monospace" font-size="14" fill="#ffffff" text-anchor="middle">1</text>
  
  <rect x="530" y="385" width="40" height="35" fill="#0f2f1f" stroke="#4ade80" stroke-width="2"/>
  <text x="550" y="408" font-family="Courier New, monospace" font-size="14" fill="#ffffff" text-anchor="middle">2</text>
  
  <rect x="570" y="385" width="40" height="35" fill="#0f2f1f" stroke="#4ade80" stroke-width="2"/>
  <text x="590" y="408" font-family="Courier New, monospace" font-size="14" fill="#ffffff" text-anchor="middle">4</text>
  
  <rect x="610" y="385" width="40" height="35" fill="#0f2f1f" stroke="#4ade80" stroke-width="2"/>
  <text x="630" y="408" font-family="Courier New, monospace" font-size="14" fill="#ffffff" text-anchor="middle">8</text>
  
  <rect x="650" y="385" width="40" height="35" fill="#1e3a5f" stroke="#3b82f6" stroke-width="2"/>
  <text x="670" y="408" font-family="Courier New, monospace" font-size="14" fill="#ffffff" text-anchor="middle">3</text>
  
  <rect x="690" y="385" width="40" height="35" fill="#1e3a5f" stroke="#3b82f6" stroke-width="2"/>
  <text x="710" y="408" font-family="Courier New, monospace" font-size="14" fill="#ffffff" text-anchor="middle">6</text>
  
  <rect x="730" y="385" width="40" height="35" fill="#1e3a5f" stroke="#3b82f6" stroke-width="2"/>
  <text x="750" y="408" font-family="Courier New, monospace" font-size="14" fill="#ffffff" text-anchor="middle">11</text>
  
  <rect x="770" y="385" width="40" height="35" fill="#3d1f0f" stroke="#f97316" stroke-width="2"/>
  <text x="790" y="408" font-family="Courier New, monospace" font-size="14" fill="#ffffff" text-anchor="middle">5</text>
  
  <rect x="810" y="385" width="40" height="35" fill="#3d1f0f" stroke="#f97316" stroke-width="2"/>
  <text x="830" y="408" font-family="Courier New, monospace" font-size="14" fill="#ffffff" text-anchor="middle">10</text>
  
  <rect x="850" y="385" width="40" height="35" fill="#2d1f3d" stroke="#a78bfa" stroke-width="2"/>
  <text x="870" y="408" font-family="Courier New, monospace" font-size="14" fill="#ffffff" text-anchor="middle">...</text>
  
  <!-- Index labels -->
  <text x="510" y="435" font-family="Courier New, monospace" font-size="9" fill="#888888" text-anchor="middle">0</text>
  <text x="550" y="435" font-family="Courier New, monospace" font-size="9" fill="#888888" text-anchor="middle">1</text>
  <text x="590" y="435" font-family="Courier New, monospace" font-size="9" fill="#888888" text-anchor="middle">2</text>
  <text x="630" y="435" font-family="Courier New, monospace" font-size="9" fill="#888888" text-anchor="middle">3</text>
  <text x="670" y="435" font-family="Courier New, monospace" font-size="9" fill="#888888" text-anchor="middle">4</text>
  <text x="710" y="435" font-family="Courier New, monospace" font-size="9" fill="#888888" text-anchor="middle">5</text>
  <text x="750" y="435" font-family="Courier New, monospace" font-size="9" fill="#888888" text-anchor="middle">6</text>
  <text x="790" y="435" font-family="Courier New, monospace" font-size="9" fill="#888888" text-anchor="middle">7</text>
  
  <!-- Path Query Example -->
  <text x="60" y="520" font-family="Courier New, monospace" font-size="14" font-weight="bold" fill="#e94560">PATH QUERY: 8 → 11</text>
  
  <rect x="40" y="535" width="400" height="80" fill="#1e3a5f" stroke="#3b82f6" stroke-width="2" rx="5"/>
  <text x="50" y="560" font-family="Courier New, monospace" font-size="11" fill="#4ade80">1. Query Chain 1: pos[8] → pos[LCA] = [3,0]</text>
  <text x="50" y="580" font-family="Courier New, monospace" font-size="11" fill="#3b82f6">2. Jump to Chain 2: pos[3] → pos[11] = [4,6]</text>
  <text x="50" y="600" font-family="Courier New, monospace" font-size="11" fill="#ffffff">3. Combine segment tree results</text>
  
  <!-- Complexity -->
  <text x="520" y="470" font-family="Courier New, monospace" font-size="14" font-weight="bold" fill="#e94560">COMPLEXITY</text>
  
  <rect x="490" y="485" width="200" height="80" fill="#0f2f1f" stroke="#4ade80" stroke-width="2" rx="5"/>
  <text x="590" y="510" font-family="Courier New, monospace" font-size="12" fill="#ffffff" text-anchor="middle">Preprocess: O(n)</text>
  <text x="590" y="530" font-family="Courier New, monospace" font-size="12" fill="#ffffff" text-anchor="middle">Path Query: O(log² n)</text>
  <text x="590" y="550" font-family="Courier New, monospace" font-size="12" fill="#ffffff" text-anchor="middle">Subtree Query: O(log n)</text>
  
  <!-- Key Property -->
  <rect x="710" y="485" width="200" height="80" fill="#3d1f0f" stroke="#f97316" stroke-width="2" rx="5"/>
  <text x="810" y="510" font-family="Courier New, monospace" font-size="12" font-weight="bold" fill="#f97316" text-anchor="middle">KEY PROPERTY</text>
  <text x="810" y="535" font-family="Courier New, monospace" font-size="11" fill="#ffffff" text-anchor="middle">Any root→leaf path</text>
  <text x="810" y="555" font-family="Courier New, monospace" font-size="11" fill="#ffffff" text-anchor="middle">has O(log n) light edges</text>
  
  <!-- Algorithm Steps -->
  <rect x="40" y="630" width="870" height="50" fill="#1e3a5f" stroke="#3b82f6" stroke-width="2" rx="5"/>
  <text x="50" y="652" font-family="Courier New, monospace" font-size="11" fill="#4ade80">BUILD: </text>
  <text x="110" y="652" font-family="Courier New, monospace" font-size="10" fill="#ffffff">1. DFS to compute subtree sizes</text>
  <text x="350" y="652" font-family="Courier New, monospace" font-size="10" fill="#ffffff">2. Mark heavy child (largest subtree)</text>
  <text x="620" y="652" font-family="Courier New, monospace" font-size="10" fill="#ffffff">3. DFS to assign positions &amp; chains</text>
  <text x="50" y="670" font-family="Courier New, monospace" font-size="11" fill="#f97316">QUERY:</text>
  <text x="110" y="670" font-family="Courier New, monospace" font-size="10" fill="#ffffff">Jump up chains toward LCA, query segment tree per chain, combine results</text>
</svg>
