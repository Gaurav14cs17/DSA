<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 950 680">
  <rect width="950" height="680" fill="#0f0f23"/>
  
  <!-- Title -->
  <text x="475" y="40" text-anchor="middle" font-family="Courier New, monospace" font-size="26" font-weight="bold" fill="#ffffff">Median from Data Stream</text>
  <text x="475" y="65" text-anchor="middle" font-family="Courier New, monospace" font-size="16" fill="#888888">Two Heaps Approach | O(log n) Insert, O(1) Query</text>
  
  <!-- Concept Section -->
  <text x="50" y="110" font-family="Courier New, monospace" font-size="14" font-weight="bold" fill="#e94560">CORE CONCEPT</text>
  
  <g transform="translate(50, 130)">
    <text x="0" y="0" font-family="Courier New, monospace" font-size="11" fill="#888888">Split stream into two halves, keep middle accessible</text>
    
    <!-- Number line -->
    <line x1="0" y1="40" x2="500" y2="40" stroke="#888888" stroke-width="1.5"/>
    
    <!-- Lower half -->
    <rect x="0" y="25" width="220" height="30" fill="#1e3a5f" stroke="#3b82f6" stroke-width="1.5" opacity="0.7"/>
    <text x="110" y="45" text-anchor="middle" font-family="Courier New, monospace" font-size="11" fill="#3b82f6">smaller half</text>
    
    <!-- Median point -->
    <circle cx="250" cy="40" r="8" fill="#f97316" stroke="#f97316" stroke-width="2"/>
    <text x="250" y="70" text-anchor="middle" font-family="Courier New, monospace" font-size="10" font-weight="bold" fill="#f97316">MEDIAN</text>
    
    <!-- Upper half -->
    <rect x="280" y="25" width="220" height="30" fill="#0f2f1f" stroke="#4ade80" stroke-width="1.5" opacity="0.7"/>
    <text x="390" y="45" text-anchor="middle" font-family="Courier New, monospace" font-size="11" fill="#4ade80">larger half</text>
  </g>
  
  <!-- Two Heaps Structure -->
  <text x="50" y="240" font-family="Courier New, monospace" font-size="14" font-weight="bold" fill="#e94560">TWO HEAPS STRUCTURE</text>
  
  <!-- Max Heap (smaller half) -->
  <g transform="translate(50, 260)">
    <rect x="0" y="0" width="250" height="180" fill="#1e3a5f" stroke="#3b82f6" stroke-width="2" rx="4"/>
    <text x="125" y="25" text-anchor="middle" font-family="Courier New, monospace" font-size="14" font-weight="bold" fill="#3b82f6">MAX-HEAP</text>
    <text x="125" y="42" text-anchor="middle" font-family="Courier New, monospace" font-size="10" fill="#888888">(smaller half)</text>
    
    <!-- Heap visualization -->
    <g transform="translate(125, 80)">
      <!-- Root (max of smaller) -->
      <circle cx="0" cy="0" r="22" fill="#3d1f0f" stroke="#f97316" stroke-width="2"/>
      <text x="0" y="5" text-anchor="middle" font-family="Courier New, monospace" font-size="14" font-weight="bold" fill="#ffffff">5</text>
      
      <!-- Level 1 -->
      <line x1="-15" y1="18" x2="-45" y2="45" stroke="#3b82f6" stroke-width="1.5"/>
      <line x1="15" y1="18" x2="45" y2="45" stroke="#3b82f6" stroke-width="1.5"/>
      
      <circle cx="-55" cy="55" r="18" fill="#1e3a5f" stroke="#3b82f6" stroke-width="1.5"/>
      <text x="-55" y="60" text-anchor="middle" font-family="Courier New, monospace" font-size="12" fill="#ffffff">3</text>
      
      <circle cx="55" cy="55" r="18" fill="#1e3a5f" stroke="#3b82f6" stroke-width="1.5"/>
      <text x="55" y="60" text-anchor="middle" font-family="Courier New, monospace" font-size="12" fill="#ffffff">4</text>
      
      <!-- Level 2 -->
      <line x1="-65" y1="70" x2="-80" y2="90" stroke="#3b82f6" stroke-width="1"/>
      <circle cx="-85" cy="100" r="15" fill="#1e3a5f" stroke="#3b82f6" stroke-width="1"/>
      <text x="-85" y="104" text-anchor="middle" font-family="Courier New, monospace" font-size="10" fill="#ffffff">1</text>
      
      <line x1="-45" y1="70" x2="-30" y2="90" stroke="#3b82f6" stroke-width="1"/>
      <circle cx="-25" cy="100" r="15" fill="#1e3a5f" stroke="#3b82f6" stroke-width="1"/>
      <text x="-25" y="104" text-anchor="middle" font-family="Courier New, monospace" font-size="10" fill="#ffffff">2</text>
    </g>
    
    <text x="125" y="170" text-anchor="middle" font-family="Courier New, monospace" font-size="10" fill="#888888">Root = max of smaller = 5</text>
  </g>
  
  <!-- Connection -->
  <g transform="translate(310, 340)">
    <line x1="0" y1="0" x2="80" y2="0" stroke="#f97316" stroke-width="3"/>
    <text x="40" y="-10" text-anchor="middle" font-family="Courier New, monospace" font-size="10" font-weight="bold" fill="#f97316">median</text>
    <text x="40" y="20" text-anchor="middle" font-family="Courier New, monospace" font-size="9" fill="#888888">(5+6)/2 = 5.5</text>
  </g>
  
  <!-- Min Heap (larger half) -->
  <g transform="translate(400, 260)">
    <rect x="0" y="0" width="250" height="180" fill="#0f2f1f" stroke="#4ade80" stroke-width="2" rx="4"/>
    <text x="125" y="25" text-anchor="middle" font-family="Courier New, monospace" font-size="14" font-weight="bold" fill="#4ade80">MIN-HEAP</text>
    <text x="125" y="42" text-anchor="middle" font-family="Courier New, monospace" font-size="10" fill="#888888">(larger half)</text>
    
    <!-- Heap visualization -->
    <g transform="translate(125, 80)">
      <!-- Root (min of larger) -->
      <circle cx="0" cy="0" r="22" fill="#3d1f0f" stroke="#f97316" stroke-width="2"/>
      <text x="0" y="5" text-anchor="middle" font-family="Courier New, monospace" font-size="14" font-weight="bold" fill="#ffffff">6</text>
      
      <!-- Level 1 -->
      <line x1="-15" y1="18" x2="-45" y2="45" stroke="#4ade80" stroke-width="1.5"/>
      <line x1="15" y1="18" x2="45" y2="45" stroke="#4ade80" stroke-width="1.5"/>
      
      <circle cx="-55" cy="55" r="18" fill="#0f2f1f" stroke="#4ade80" stroke-width="1.5"/>
      <text x="-55" y="60" text-anchor="middle" font-family="Courier New, monospace" font-size="12" fill="#ffffff">8</text>
      
      <circle cx="55" cy="55" r="18" fill="#0f2f1f" stroke="#4ade80" stroke-width="1.5"/>
      <text x="55" y="60" text-anchor="middle" font-family="Courier New, monospace" font-size="12" fill="#ffffff">7</text>
      
      <!-- Level 2 -->
      <line x1="-65" y1="70" x2="-80" y2="90" stroke="#4ade80" stroke-width="1"/>
      <circle cx="-85" cy="100" r="15" fill="#0f2f1f" stroke="#4ade80" stroke-width="1"/>
      <text x="-85" y="104" text-anchor="middle" font-family="Courier New, monospace" font-size="10" fill="#ffffff">9</text>
      
      <line x1="-45" y1="70" x2="-30" y2="90" stroke="#4ade80" stroke-width="1"/>
      <circle cx="-25" cy="100" r="15" fill="#0f2f1f" stroke="#4ade80" stroke-width="1"/>
      <text x="-25" y="104" text-anchor="middle" font-family="Courier New, monospace" font-size="10" fill="#ffffff">10</text>
    </g>
    
    <text x="125" y="170" text-anchor="middle" font-family="Courier New, monospace" font-size="10" fill="#888888">Root = min of larger = 6</text>
  </g>
  
  <!-- Invariants Box -->
  <g transform="translate(680, 260)">
    <rect x="0" y="0" width="240" height="120" fill="#2d1f3d" stroke="#a78bfa" stroke-width="2" rx="4"/>
    <text x="120" y="25" text-anchor="middle" font-family="Courier New, monospace" font-size="12" font-weight="bold" fill="#a78bfa">INVARIANTS</text>
    <line x1="15" y1="35" x2="225" y2="35" stroke="#a78bfa" stroke-width="1" opacity="0.5"/>
    
    <text x="20" y="55" font-family="Courier New, monospace" font-size="10" fill="#ffffff">1. |small| - |large| ≤ 1</text>
    <text x="20" y="75" font-family="Courier New, monospace" font-size="10" fill="#ffffff">2. max(small) ≤ min(large)</text>
    <text x="20" y="95" font-family="Courier New, monospace" font-size="10" fill="#ffffff">3. |small| ≥ |large|</text>
    <text x="30" y="110" font-family="Courier New, monospace" font-size="9" fill="#888888">(small holds more if odd)</text>
  </g>
  
  <!-- Add Number Algorithm -->
  <text x="50" y="480" font-family="Courier New, monospace" font-size="14" font-weight="bold" fill="#e94560">ADD NUMBER ALGORITHM</text>
  
  <g transform="translate(50, 500)">
    <!-- Step 1 -->
    <rect x="0" y="0" width="180" height="50" fill="#3d1f0f" stroke="#f97316" stroke-width="1.5" rx="4"/>
    <text x="90" y="20" text-anchor="middle" font-family="Courier New, monospace" font-size="10" font-weight="bold" fill="#f97316">1. Determine heap</text>
    <text x="90" y="38" text-anchor="middle" font-family="Courier New, monospace" font-size="9" fill="#ffffff">num ≤ max(small)?</text>
    
    <!-- Arrows to options -->
    <line x1="180" y1="18" x2="210" y2="18" stroke="#4ade80" stroke-width="1.5"/>
    <text x="195" y="10" font-family="Courier New, monospace" font-size="8" fill="#4ade80">yes</text>
    
    <line x1="180" y1="35" x2="210" y2="55" stroke="#ef4444" stroke-width="1.5"/>
    <text x="195" y="55" font-family="Courier New, monospace" font-size="8" fill="#ef4444">no</text>
    
    <!-- Small heap option -->
    <rect x="210" y="0" width="120" height="30" fill="#1e3a5f" stroke="#3b82f6" stroke-width="1.5" rx="4"/>
    <text x="270" y="20" text-anchor="middle" font-family="Courier New, monospace" font-size="9" fill="#ffffff">→ add to small</text>
    
    <!-- Large heap option -->
    <rect x="210" y="40" width="120" height="30" fill="#0f2f1f" stroke="#4ade80" stroke-width="1.5" rx="4"/>
    <text x="270" y="60" text-anchor="middle" font-family="Courier New, monospace" font-size="9" fill="#ffffff">→ add to large</text>
    
    <!-- Step 2 -->
    <line x1="330" y1="35" x2="360" y2="35" stroke="#888888" stroke-width="1.5"/>
    <polygon points="360,35 352,30 352,40" fill="#888888"/>
    
    <rect x="360" y="10" width="200" height="50" fill="#2d1f3d" stroke="#a78bfa" stroke-width="1.5" rx="4"/>
    <text x="460" y="28" text-anchor="middle" font-family="Courier New, monospace" font-size="10" font-weight="bold" fill="#a78bfa">2. Rebalance if needed</text>
    <text x="460" y="45" text-anchor="middle" font-family="Courier New, monospace" font-size="9" fill="#ffffff">Move root between heaps</text>
    
    <!-- Step 3 -->
    <line x1="560" y1="35" x2="590" y2="35" stroke="#888888" stroke-width="1.5"/>
    <polygon points="590,35 582,30 582,40" fill="#888888"/>
    
    <rect x="590" y="10" width="160" height="50" fill="#0f2f1f" stroke="#4ade80" stroke-width="1.5" rx="4"/>
    <text x="670" y="28" text-anchor="middle" font-family="Courier New, monospace" font-size="10" font-weight="bold" fill="#4ade80">3. Done!</text>
    <text x="670" y="45" text-anchor="middle" font-family="Courier New, monospace" font-size="9" fill="#ffffff">Invariants restored</text>
  </g>
  
  <!-- Example walkthrough -->
  <text x="50" y="590" font-family="Courier New, monospace" font-size="14" font-weight="bold" fill="#e94560">EXAMPLE: Stream [2, 3, 1, 5, 4]</text>
  
  <g transform="translate(50, 610)">
    <!-- Add 2 -->
    <g transform="translate(0, 0)">
      <rect x="0" y="0" width="85" height="50" fill="#1e3a5f" stroke="#3b82f6" stroke-width="1" rx="2"/>
      <text x="43" y="15" text-anchor="middle" font-family="Courier New, monospace" font-size="9" fill="#3b82f6">+2</text>
      <text x="43" y="30" text-anchor="middle" font-family="Courier New, monospace" font-size="8" fill="#ffffff">S:[2] L:[]</text>
      <text x="43" y="43" text-anchor="middle" font-family="Courier New, monospace" font-size="8" fill="#f97316">med=2</text>
    </g>
    
    <line x1="90" y1="25" x2="110" y2="25" stroke="#888888" stroke-width="1"/>
    
    <!-- Add 3 -->
    <g transform="translate(115, 0)">
      <rect x="0" y="0" width="95" height="50" fill="#1e3a5f" stroke="#3b82f6" stroke-width="1" rx="2"/>
      <text x="48" y="15" text-anchor="middle" font-family="Courier New, monospace" font-size="9" fill="#3b82f6">+3</text>
      <text x="48" y="30" text-anchor="middle" font-family="Courier New, monospace" font-size="8" fill="#ffffff">S:[2] L:[3]</text>
      <text x="48" y="43" text-anchor="middle" font-family="Courier New, monospace" font-size="8" fill="#f97316">med=2.5</text>
    </g>
    
    <line x1="215" y1="25" x2="235" y2="25" stroke="#888888" stroke-width="1"/>
    
    <!-- Add 1 -->
    <g transform="translate(240, 0)">
      <rect x="0" y="0" width="105" height="50" fill="#1e3a5f" stroke="#3b82f6" stroke-width="1" rx="2"/>
      <text x="53" y="15" text-anchor="middle" font-family="Courier New, monospace" font-size="9" fill="#3b82f6">+1</text>
      <text x="53" y="30" text-anchor="middle" font-family="Courier New, monospace" font-size="8" fill="#ffffff">S:[2,1] L:[3]</text>
      <text x="53" y="43" text-anchor="middle" font-family="Courier New, monospace" font-size="8" fill="#f97316">med=2</text>
    </g>
    
    <line x1="350" y1="25" x2="370" y2="25" stroke="#888888" stroke-width="1"/>
    
    <!-- Add 5 -->
    <g transform="translate(375, 0)">
      <rect x="0" y="0" width="115" height="50" fill="#1e3a5f" stroke="#3b82f6" stroke-width="1" rx="2"/>
      <text x="58" y="15" text-anchor="middle" font-family="Courier New, monospace" font-size="9" fill="#3b82f6">+5</text>
      <text x="58" y="30" text-anchor="middle" font-family="Courier New, monospace" font-size="8" fill="#ffffff">S:[2,1] L:[3,5]</text>
      <text x="58" y="43" text-anchor="middle" font-family="Courier New, monospace" font-size="8" fill="#f97316">med=2.5</text>
    </g>
    
    <line x1="495" y1="25" x2="515" y2="25" stroke="#888888" stroke-width="1"/>
    
    <!-- Add 4 -->
    <g transform="translate(520, 0)">
      <rect x="0" y="0" width="130" height="50" fill="#0f2f1f" stroke="#4ade80" stroke-width="1.5" rx="2"/>
      <text x="65" y="15" text-anchor="middle" font-family="Courier New, monospace" font-size="9" fill="#4ade80">+4</text>
      <text x="65" y="30" text-anchor="middle" font-family="Courier New, monospace" font-size="8" fill="#ffffff">S:[3,2,1] L:[4,5]</text>
      <text x="65" y="43" text-anchor="middle" font-family="Courier New, monospace" font-size="8" fill="#f97316">med=3</text>
    </g>
  </g>
  
  <!-- Complexity Box -->
  <rect x="700" y="400" width="220" height="100" fill="#1e3a5f" stroke="#3b82f6" stroke-width="2" rx="4"/>
  <text x="810" y="425" text-anchor="middle" font-family="Courier New, monospace" font-size="12" font-weight="bold" fill="#3b82f6">COMPLEXITY</text>
  <line x1="715" y1="435" x2="905" y2="435" stroke="#3b82f6" stroke-width="1" opacity="0.5"/>
  <text x="720" y="458" font-family="Courier New, monospace" font-size="11" fill="#ffffff">addNum()     O(log n)</text>
  <text x="720" y="478" font-family="Courier New, monospace" font-size="11" fill="#ffffff">findMedian() O(1)</text>
  <text x="720" y="495" font-family="Courier New, monospace" font-size="10" fill="#888888">Space: O(n)</text>
</svg>

